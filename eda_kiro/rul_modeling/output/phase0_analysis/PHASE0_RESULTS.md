# Phase 0: 探索的特徴量分析 - 結果レポート

## 🎯 目的

モデル実装前に、特徴量とRULの相関を確認し、有効な特徴量を特定する。

## 📊 分析対象

- **コンデンサ**: ES12C1
- **サイクル数**: 200サイクル
- **抽出特徴量**: 30個

## ✅ 結果サマリー

### 成功基準の達成状況

- ✅ **高相関特徴量（|r| > 0.5）**: **10個** （目標: 5個以上）
- ✅ **成功基準達成！** Phase 1（データセット構築）に進めます

## 📈 高相関特徴量（|r| > 0.5）

| 順位 | 特徴量 | 相関係数 | p値 | 評価 |
|------|--------|----------|-----|------|
| 1 | cycle_normalized | -1.000 | 0.000 | 完全な負の相関（定義上） |
| 2 | cycle_number | -1.000 | 0.000 | 完全な負の相関（定義上） |
| 3 | vo_cv | -0.749 | 2.56e-37 | 強い負の相関 ⭐ |
| 4 | vo_max | 0.695 | 3.84e-30 | 強い正の相関 ⭐ |
| 5 | vo_mean | 0.690 | 1.40e-29 | 強い正の相関 ⭐ |
| 6 | vo_q75 | 0.690 | 1.40e-29 | 強い正の相関 |
| 7 | vo_q25 | 0.690 | 1.42e-29 | 強い正の相関 |
| 8 | vo_median | 0.690 | 1.47e-29 | 強い正の相関 |
| 9 | vo_min | 0.688 | 2.51e-29 | 強い正の相関 |
| 10 | vl_cv | 0.687 | 2.90e-29 | 強い正の相関 ⭐ |

## 📉 中相関特徴量（0.3 < |r| < 0.5）

| 特徴量 | 相関係数 | 評価 |
|--------|----------|------|
| vl_max | 0.487 | 中程度の正の相関 |
| vl_q25 | 0.468 | 中程度の正の相関 |
| vl_mean | 0.467 | 中程度の正の相関 |
| vl_median | 0.465 | 中程度の正の相関 |
| vl_q75 | 0.464 | 中程度の正の相関 |
| response_efficiency | 0.462 | 中程度の正の相関 |
| vl_min | 0.424 | 中程度の正の相関 |
| signal_attenuation | -0.405 | 中程度の負の相関 |
| vo_range | 0.396 | 中程度の正の相関 |
| vl_std | -0.365 | 中程度の負の相関 |
| vl_trend | -0.305 | 中程度の負の相関 |

## ⚠️ 低相関特徴量（|r| < 0.3）

| 特徴量 | 相関係数 | 評価 |
|--------|----------|------|
| voltage_ratio | 0.248 | 弱い相関 ⚠️ |
| vo_std | 0.247 | 弱い相関 |
| voltage_ratio_std | 0.205 | 弱い相関 |
| vo_trend | 0.064 | ほぼ無相関 |
| vl_range | 0.058 | ほぼ無相関 |

## 💡 重要な発見

### 1. VO（出力電圧）関連の特徴量が非常に有効

- **vo_cv（変動係数）**: r = -0.749 - 最も強い相関
- **vo_mean, vo_max, vo_min**: すべて r > 0.68
- VOの統計量がRUL予測に非常に有効

### 2. VL（入力電圧）の変動係数も有効

- **vl_cv**: r = 0.687
- VLの変動性も劣化指標として有用

### 3. EDAで重要視した電圧比は意外と低相関

- **voltage_ratio**: r = 0.248（弱い相関）
- EDAでは劣化パターンが見えたが、単純な相関は低い
- 理由: 非線形な関係、または他の特徴量との組み合わせで効果を発揮

### 4. 履歴特徴量は未計算

- `voltage_ratio_mean_last_5`などは相関係数が計算されていない
- 履歴特徴量の計算は時間がかかるため、今回は省略
- 必要に応じて後で追加可能

## 🎯 推奨事項

### Phase 1（データセット構築）で使用する特徴量

#### 必須特徴量（高相関）
1. `vo_cv` - 出力電圧の変動係数
2. `vo_mean` - 出力電圧の平均
3. `vo_max` - 出力電圧の最大値
4. `vl_cv` - 入力電圧の変動係数
5. `cycle_normalized` - 正規化サイクル番号

#### 有用な特徴量（中相関）
6. `vl_mean` - 入力電圧の平均
7. `response_efficiency` - 応答効率
8. `signal_attenuation` - 信号減衰

#### 検討が必要な特徴量
- `voltage_ratio` - 相関は低いが、EDAで有効性を確認済み
- 非線形モデル（Random Forest, XGBoost）では効果を発揮する可能性

### 削除候補の特徴量

- `vo_trend`, `vl_range` - ほぼ無相関
- ただし、モデル学習後の特徴量重要度で再評価

## 📁 出力ファイル

1. **特徴量データ**: `es12c1_features.csv` (200行 × 32列)
2. **相関分析結果**: `feature_correlations.csv` (30特徴量)
3. **可視化**: `feature_trends_quick.png` (上位6特徴量のトレンド)

## 🚀 次のステップ

### Phase 1: データセット構築

1. **全8コンデンサから特徴量を抽出**
   - ES12C1～ES12C8
   - 各200サイクル
   - 合計1600サンプル

2. **ラベル生成**
   - Primary Model用: Normal/Abnormal（前半50%/後半50%）
   - Secondary Model用: RUL（200 - cycle_number）

3. **データ分割**
   - Train: C1-C5の1-150サイクル（750サンプル）
   - Val: C6の1-150サイクル（150サンプル）
   - Test: C7-C8の1-200サイクル（400サンプル）

4. **特徴量スケーリング**
   - StandardScaler適用

---

**分析日**: 2026-01-16
**分析者**: Phase 0 探索的特徴量分析スクリプト
**データ**: ES12C1（200サイクル）
